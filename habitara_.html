<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habitara - AI-Powered Habit Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Landing Page Styles */
        .landing-page {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
        }

        .landing-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 100%;
        }

        .logo {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .landing-title {
            color: #333;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .landing-subtitle {
            color: #666;
            font-size: 1.2rem;
            margin-bottom: 40px;
            font-style: italic;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-radius: 8px;
            overflow: hidden;
            background: #f8f9fa;
        }

        .tab {
            flex: 1;
            padding: 12px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        /* Dashboard Styles */
        .dashboard {
            display: none;
            min-height: 100vh;
        }

        .dashboard.active {
            display: flex;
        }

        .sidebar {
            width: 280px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 20px;
            margin-right: 20px;
            height: fit-content;
        }

        .sidebar-header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 20px;
        }

        .sidebar-logo {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .sidebar-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .sidebar-subtitle {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-link:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }

        .nav-link.active {
            background: rgba(255,255,255,0.2);
            border-left: 4px solid #ffd700;
        }

        .nav-icon {
            margin-right: 12px;
            font-size: 1.2rem;
        }

        .main-content {
            flex: 1;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Metrics Cards */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
        }

        .metric-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 8px;
        }

        .metric-label {
            color: #666;
            font-size: 0.9rem;
        }

        /* Habit Cards */
        .habits-grid {
            display: grid;
            gap: 20px;
        }

        .habit-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .habit-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }

        .habit-info {
            flex: 1;
        }

        .habit-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .habit-meta {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 12px;
        }

        .habit-badges {
            display: flex;
            gap: 8px;
        }

        .badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .badge.success {
            background: #c6f6d5;
            color: #2f855a;
        }

        .badge.warning {
            background: #fef5e7;
            color: #c05621;
        }

        .badge.danger {
            background: #fed7d7;
            color: #c53030;
        }

        .badge.primary {
            background: #bee3f8;
            color: #2b6cb0;
        }

        .habit-actions {
            display: flex;
            gap: 8px;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .btn-edit {
            background: #e3f2fd;
            color: #1976d2;
        }

        .btn-delete {
            background: #ffebee;
            color: #d32f2f;
        }

        .btn-icon:hover {
            transform: scale(1.1);
        }

        /* Tracking Grid */
        .tracking-container {
            margin-top: 20px;
        }

        .tracking-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .view-selector {
            display: flex;
            gap: 8px;
        }

        .view-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: transparent;
            color: #667eea;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-btn.active {
            background: #667eea;
            color: white;
        }

        .tracking-grid {
            display: grid;
            gap: 16px;
        }

        .tracking-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }

        .tracking-item:hover {
            border-color: #667eea;
        }

        .tracking-item.completed {
            background: #f0fff4;
            border-color: #48bb78;
        }

        .checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #e2e8f0;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .checkbox.checked {
            background: #48bb78;
            border-color: #48bb78;
            color: white;
        }

        /* Progress Charts */
        .chart-container {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 24px;
        }

        .chart-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .chart-placeholder {
            height: 300px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 1.1rem;
        }

        /* AI Insights */
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .risk-card {
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .risk-high {
            background: #fed7d7;
            border: 2px solid #f56565;
        }

        .risk-medium {
            background: #fef5e7;
            border: 2px solid #ed8936;
        }

        .risk-low {
            background: #f0fff4;
            border: 2px solid #48bb78;
        }

        .risk-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .suggestions-list {
            list-style: none;
            margin-top: 20px;
        }

        .suggestion-item {
            background: #e6fffa;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 4px solid #38b2ac;
        }

        /* Settings */
        .settings-section {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid #e2e8f0;
        }

        .settings-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .profile-picture {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #667eea;
            margin-bottom: 16px;
        }

        .profile-placeholder {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: #667eea;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            margin-bottom: 16px;
        }

        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 16px 0;
        }

        .toggle-switch {
            width: 60px;
            height: 30px;
            background: #e2e8f0;
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.active {
            background: #667eea;
        }

        .toggle-slider {
            width: 26px;
            height: 26px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(30px);
        }

        .language-selector {
            display: flex;
            gap: 12px;
            margin: 16px 0;
        }

        .language-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: transparent;
            color: #667eea;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .language-btn.active {
            background: #667eea;
            color: white;
        }

        /* Dark Theme */
        .dark-theme {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
        }

        .dark-theme .main-content {
            background: #2d3748;
            color: #e2e8f0;
        }

        .dark-theme .metric-card,
        .dark-theme .habit-card,
        .dark-theme .tracking-item,
        .dark-theme .chart-container {
            background: #4a5568;
            color: #e2e8f0;
            border-color: #718096;
        }

        .dark-theme .page-title,
        .dark-theme .habit-name,
        .dark-theme .chart-title,
        .dark-theme .settings-title {
            color: #e2e8f0;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .dashboard {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                margin-right: 0;
                margin-bottom: 20px;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }

            .insights-grid {
                grid-template-columns: 1fr;
            }

            .settings-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }

        .notification.success {
            background: #48bb78;
        }

        .notification.error {
            background: #f56565;
        }

        .notification.warning {
            background: #ed8936;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .select-group {
            margin-bottom: 20px;
        }

        .select-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            background: white;
        }

        .textarea-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            resize: vertical;
            min-height: 100px;
        }
    </style>
</head>
<body>
    <!-- Landing Page -->
    <div id="landingPage" class="landing-page">
        <div class="landing-content">
            <div class="logo">🎯</div>
            <h1 class="landing-title" id="welcomeTitle">Welcome to Habitara</h1>
            <p class="landing-subtitle" id="welcomeSubtitle">The Excellence Habit Angle</p>
            
            <div class="tabs">
                <button class="tab active" onclick="switchTab('login')">Login</button>
                <button class="tab" onclick="switchTab('register')">Create Account</button>
            </div>
            
            <!-- Login Form -->
            <div id="loginForm" class="form-container">
                <div class="form-group">
                    <label for="loginUsername">Username</label>
                    <input type="text" id="loginUsername" placeholder="Enter your username">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password">
                </div>
                <button class="btn" onclick="login()">Login</button>
            </div>
            
            <!-- Register Form -->
            <div id="registerForm" class="form-container" style="display: none;">
                <div class="form-group">
                    <label for="registerFullName">Full Name</label>
                    <input type="text" id="registerFullName" placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label for="registerUsername">Username</label>
                    <input type="text" id="registerUsername" placeholder="Choose a username">
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" placeholder="Create a password">
                </div>
                <button class="btn" onclick="register()">Create Account</button>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="dashboard container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">🎯</div>
                <h2 class="sidebar-title">Habitara</h2>
                <p class="sidebar-subtitle" id="sidebarSubtitle">The Excellence Habit Angle</p>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a class="nav-link active" onclick="showPage('dashboardHome')">
                        <span class="nav-icon">🏠</span>
                        <span id="navDashboard">Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage('habits')">
                        <span class="nav-icon">📋</span>
                        <span id="navHabits">Habits</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage('tracking')">
                        <span class="nav-icon">✅</span>
                        <span id="navTracking">Tracking</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage('progress')">
                        <span class="nav-icon">📊</span>
                        <span id="navProgress">Progress</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage('aiInsights')">
                        <span class="nav-icon">🤖</span>
                        <span id="navAI">AI Insights</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage('settings')">
                        <span class="nav-icon">⚙️</span>
                        <span id="navSettings">Settings</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="logout()">
                        <span class="nav-icon">🚪</span>
                        <span id="navLogout">Logout</span>
                    </a>
                </li>
            </ul>
            
            <div style="margin-top: 30px; text-align: center; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 12px;">
                <div style="font-size: 2rem; margin-bottom: 8px;">👤</div>
                <p style="margin: 0; font-weight: 500;" id="currentUser">User</p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Home Page -->
            <div id="dashboardHome" class="page active">
                <h1 class="page-title">
                    <span>🏠</span>
                    <span id="dashboardTitle">Dashboard</span>
                </h1>
                
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-icon">🎯</div>
                        <div class="metric-value" id="totalHabits">0</div>
                        <div class="metric-label" id="totalHabitsLabel">Total Habits</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">📈</div>
                        <div class="metric-value" id="todayProgress">0%</div>
                        <div class="metric-label" id="todayProgressLabel">Today's Progress</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">🔥</div>
                        <div class="metric-value" id="longestStreak">0</div>
                        <div class="metric-label" id="longestStreakLabel">Longest Streak</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">✅</div>
                        <div class="metric-value" id="completedToday">0</div>
                        <div class="metric-label" id="completedTodayLabel">Completed Today</div>
                    </div>
                </div>
                
                <h2 style="margin-bottom: 20px;">📋 Today's Habits</h2>
                <div id="todayHabits" class="habits-grid">
                    <!-- Today's habits will be populated here -->
                </div>
            </div>

            <!-- Habits Page -->
            <div id="habits" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <h1 class="page-title">
                        <span>📋</span>
                        <span id="habitsTitle">Habits</span>
                    </h1>
                    <button class="btn" onclick="showAddHabitModal()">➕ Add Habit</button>
                </div>
                
                <div id="habitsList" class="habits-grid">
                    <!-- Habits will be populated here -->
                </div>
            </div>

            <!-- Tracking Page -->
            <div id="tracking" class="page">
                <h1 class="page-title">
                    <span>✅</span>
                    <span id="trackingTitle">Tracking</span>
                </h1>
                
                <div class="tracking-header">
                    <div class="view-selector">
                        <button class="view-btn active" onclick="switchTrackingView('daily')">Daily</button>
                        <button class="view-btn" onclick="switchTrackingView('weekly')">Weekly</button>
                        <button class="view-btn" onclick="switchTrackingView('monthly')">Monthly</button>
                    </div>
                    <div>
                        <button class="btn btn-secondary" onclick="saveTracking()">💾 Save</button>
                        <button class="btn btn-secondary" onclick="resetTracking()">🔄 Reset</button>
                    </div>
                </div>
                
                <div id="trackingContent" class="tracking-container">
                    <!-- Tracking content will be populated here -->
                </div>
            </div>

            <!-- Progress Page -->
            <div id="progress" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <h1 class="page-title">
                        <span>📊</span>
                        <span id="progressTitle">Progress</span>
                    </h1>
                    <button class="btn" onclick="exportCSV()">📤 Export CSV</button>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">📈 Daily Completion Rate</h3>
                    <div class="chart-placeholder">Interactive chart showing daily completion trends</div>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">🔥 Current Streaks</h3>
                    <div class="chart-placeholder">Bar chart showing current streaks for each habit</div>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">🎯 Success Rate by Category</h3>
                    <div class="chart-placeholder">Pie chart showing success rates by habit category</div>
                </div>
            </div>

            <!-- AI Insights Page -->
            <div id="aiInsights" class="page">
                <h1 class="page-title">
                    <span>🤖</span>
                    <span id="aiInsightsTitle">AI Insights</span>
                </h1>
                
                <h2 style="margin-bottom: 20px;">⚠️ Risk Analysis</h2>
                <div class="insights-grid">
                    <div class="risk-card risk-high">
                        <h3 class="risk-title">🔴 High Risk</h3>
                        <div id="highRiskHabits">
                            <p>No high-risk habits! 🎉</p>
                        </div>
                    </div>
                    <div class="risk-card risk-medium">
                        <h3 class="risk-title">🟡 Medium Risk</h3>
                        <div id="mediumRiskHabits">
                            <p>No medium-risk habits!</p>
                        </div>
                    </div>
                    <div class="risk-card risk-low">
                        <h3 class="risk-title">🟢 Low Risk</h3>
                        <div id="lowRiskHabits">
                            <p>Keep building habits!</p>
                        </div>
                    </div>
                </div>
                
                <h2 style="margin-bottom: 20px;">💡 AI Suggestions</h2>
                <ul id="aiSuggestions" class="suggestions-list">
                    <li class="suggestion-item">Start by adding your first habit! Focus on something small and achievable.</li>
                </ul>
                
                <h2 style="margin-bottom: 20px;">🏆 Badges & Achievements</h2>
                <div id="badgesContainer" class="insights-grid">
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <p>Keep building habits to earn your first badge!</p>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settings" class="page">
                <h1 class="page-title">
                    <span>⚙️</span>
                    <span id="settingsTitle">Settings</span>
                </h1>
                
                <div class="settings-section">
                    <h2 class="settings-title">👤 Profile Settings</h2>
                    <div class="settings-grid">
                        <div style="text-align: center;">
                            <div id="profilePicture" class="profile-placeholder">👤</div>
                            <input type="file" id="profilePictureInput" accept="image/*" style="display: none;" onchange="uploadProfilePicture()">
                            <button class="btn btn-secondary" onclick="document.getElementById('profilePictureInput').click()">Upload Picture</button>
                            <button class="btn btn-secondary" onclick="resetProfilePicture()" style="margin-top: 8px;">Reset Picture</button>
                        </div>
                        <div>
                            <div class="form-group">
                                <label for="profileFullName">Full Name</label>
                                <input type="text" id="profileFullName" placeholder="Enter your full name">
                            </div>
                            <div class="form-group">
                                <label for="profileEmail">Email</label>
                                <input type="email" id="profileEmail" placeholder="Enter your email">
                            </div>
                            <div class="form-group">
                                <label for="profileUsername">Username</label>
                                <input type="text" id="profileUsername" placeholder="Enter your username">
                            </div>
                            <button class="btn" onclick="updateProfile()">Update Profile</button>
                        </div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h2 class="settings-title">🎨 App Settings</h2>
                    <div class="settings-grid">
                        <div>
                            <h3>Theme</h3>
                            <div class="theme-toggle">
                                <span>☀️ Light</span>
                                <div class="toggle-switch" id="themeToggle" onclick="toggleTheme()">
                                    <div class="toggle-slider"></div>
                                </div>
                                <span>🌙 Dark</span>
                            </div>
                        </div>
                        <div>
                            <h3>Language</h3>
                            <div class="language-selector">
                                <button class="language-btn active" onclick="setLanguage('en')">🇺🇸 English</button>
                                <button class="language-btn" onclick="setLanguage('hi')">🇮🇳 हिंदी</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h2 class="settings-title">🔒 Privacy Settings</h2>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="enableNotifications" checked> Enable Notifications
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="shareProgress"> Share Progress Publicly
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="reminderTime">Daily Reminder Time</label>
                        <input type="time" id="reminderTime" value="09:00">
                    </div>
                    <button class="btn" onclick="savePrivacySettings()">Save Privacy Settings</button>
                </div>
                
                <div class="settings-section">
                    <h2 class="settings-title">🔄 Reset Settings</h2>
                    <p style="color: #f56565; margin-bottom: 16px;">This will reset all your settings to default values.</p>
                    <button class="btn btn-secondary" onclick="resetAllSettings()">Reset All Settings</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Habit Modal -->
    <div id="addHabitModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add New Habit</h2>
                <button class="close-btn" onclick="closeAddHabitModal()">&times;</button>
            </div>
            
            <div class="form-group">
                <label for="habitName">Habit Name</label>
                <input type="text" id="habitName" placeholder="Enter habit name">
            </div>
            
            <div class="select-group">
                <label for="habitCategory">Category</label>
                <select id="habitCategory">
                    <option value="Learning">📚 Learning</option>
                    <option value="Saving">💰 Saving</option>
                    <option value="Health">🏥 Health</option>
                    <option value="Fitness">💪 Fitness</option>
                    <option value="Productivity">⚡ Productivity</option>
                    <option value="Mindfulness">🧘 Mindfulness</option>
                    <option value="Reading">📖 Reading</option>
                    <option value="Social">👥 Social</option>
                    <option value="Custom">🎯 Custom</option>
                </select>
            </div>
            
            <div class="select-group">
                <label for="habitFrequency">Frequency</label>
                <select id="habitFrequency">
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="habitTargetTime">Target Time (Optional)</label>
                <input type="time" id="habitTargetTime">
            </div>
            
            <div class="textarea-group">
                <label for="habitDescription">Description (Optional)</label>
                <textarea id="habitDescription" placeholder="Enter habit description"></textarea>
            </div>
            
            <div class="form-row">
                <button class="btn" onclick="addHabit()">Save Habit</button>
                <button class="btn btn-secondary" onclick="closeAddHabitModal()">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let currentLanguage = 'en';
        let currentTheme = 'light';
        let habits = [];
        let tracking = {};
        let currentTrackingView = 'daily';

        // Translations
        const translations = {
            en: {
                welcome: 'Welcome to Habitara',
                subtitle: 'The Excellence Habit Angle',
                dashboard: 'Dashboard',
                habits: 'Habits',
                tracking: 'Tracking',
                progress: 'Progress',
                aiInsights: 'AI Insights',
                settings: 'Settings',
                logout: 'Logout',
                totalHabits: 'Total Habits',
                todayProgress: "Today's Progress",
                longestStreak: 'Longest Streak',
                completedToday: 'Completed Today'
            },
            hi: {
                welcome: 'हैबिटारा में आपका स्वागत है',
                subtitle: 'उत्कृष्टता की आदत का कोण',
                dashboard: 'डैशबोर्ड',
                habits: 'आदतें',
                tracking: 'ट्रैकिंग',
                progress: 'प्रगति',
                aiInsights: 'AI अंतर्दृष्टि',
                settings: 'सेटिंग्स',
                logout: 'लॉगआउट',
                totalHabits: 'कुल आदतें',
                todayProgress: 'आज की प्रगति',
                longestStreak: 'सबसे लंबी स्ट्रीक',
                completedToday: 'आज पूर्ण'
            }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadUserData();
            updateDashboard();
            checkNotifications();
        });

        // Authentication functions
        function switchTab(tab) {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            if (tab === 'login') {
                document.getElementById('loginForm').style.display = 'block';
                document.getElementById('registerForm').style.display = 'none';
            } else {
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('registerForm').style.display = 'block';
            }
        }

        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            if (!username || !password) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            // Simulate authentication
            const users = JSON.parse(localStorage.getItem('habitara_users') || '{}');
            
            if (users[username] && users[username].password === password) {
                currentUser = username;
                localStorage.setItem('habitara_current_user', username);
                
                document.getElementById('landingPage').style.display = 'none';
                document.getElementById('dashboard').classList.add('active');
                document.getElementById('currentUser').textContent = username;
                
                loadUserData();
                updateDashboard();
                showNotification('Login successful!', 'success');
            } else {
                showNotification('Invalid credentials!', 'error');
            }
        }

        function register() {
            const fullName = document.getElementById('registerFullName').value;
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;

            if (!fullName || !username || !email || !password) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            const users = JSON.parse(localStorage.getItem('habitara_users') || '{}');
            
            if (users[username]) {
                showNotification('Username already exists!', 'error');
                return;
            }

            users[username] = {
                fullName,
                email,
                password,
                createdAt: new Date().toISOString(),
                theme: 'light',
                language: 'en'
            };

            localStorage.setItem('habitara_users', JSON.stringify(users));
            
            currentUser = username;
            localStorage.setItem('habitara_current_user', username);
            
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('dashboard').classList.add('active');
            document.getElementById('currentUser').textContent = username;
            
            showNotification('Account created successfully!', 'success');
            updateDashboard();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('habitara_current_user');
            
            document.getElementById('dashboard').classList.remove('active');
            document.getElementById('landingPage').style.display = 'flex';
            
            // Reset forms
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
            
            showNotification('Logged out successfully!', 'success');
        }

        // Navigation functions
        function showPage(pageId) {
            // Hide all pages
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Update navigation
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));
            event.target.closest('.nav-link').classList.add('active');
            
            // Load page-specific data
            if (pageId === 'habits') {
                loadHabits();
            } else if (pageId === 'tracking') {
                loadTracking();
            } else if (pageId === 'progress') {
                loadProgress();
            } else if (pageId === 'aiInsights') {
                loadAIInsights();
            } else if (pageId === 'settings') {
                loadSettings();
            }
        }

        // Data management functions
        function loadUserData() {
            const savedUser = localStorage.getItem('habitara_current_user');
            if (savedUser) {
                currentUser = savedUser;
                document.getElementById('currentUser').textContent = savedUser;
                
                // Load user habits
                habits = JSON.parse(localStorage.getItem(`habitara_habits_${currentUser}`) || '[]');
                tracking = JSON.parse(localStorage.getItem(`habitara_tracking_${currentUser}`) || '{}');
                
                // Load user settings
                const users = JSON.parse(localStorage.getItem('habitara_users') || '{}');
                if (users[currentUser]) {
                    currentTheme = users[currentUser].theme || 'light';
                    currentLanguage = users[currentUser].language || 'en';
                    applyTheme();
                    applyLanguage();
                }
            }
        }

        function saveUserData() {
            if (currentUser) {
                localStorage.setItem(`habitara_habits_${currentUser}`, JSON.stringify(habits));
                localStorage.setItem(`habitara_tracking_${currentUser}`, JSON.stringify(tracking));
            }
        }

        // Dashboard functions
        function updateDashboard() {
            if (!currentUser) return;
            
            const today = new Date().toISOString().split('T')[0];
            const dailyHabits = habits.filter(h => h.frequency === 'daily');
            
            // Update metrics
            document.getElementById('totalHabits').textContent = habits.length;
            
            const todayTracking = tracking[today] || {};
            const completedToday = dailyHabits.filter(h => todayTracking[h.id]).length;
            const todayProgress = dailyHabits.length > 0 ? Math.round((completedToday / dailyHabits.length) * 100) : 0;
            
            document.getElementById('todayProgress').textContent = todayProgress + '%';
            document.getElementById('completedToday').textContent = completedToday;
            document.getElementById('longestStreak').textContent = calculateLongestStreak();
            
            // Update today's habits
            const todayHabitsContainer = document.getElementById('todayHabits');
            todayHabitsContainer.innerHTML = '';
            
            if (dailyHabits.length === 0) {
                todayHabitsContainer.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">No daily habits yet. Add some habits to get started!</p>';
                return;
            }
            
            dailyHabits.forEach(habit => {
                const isCompleted = todayTracking[habit.id] || false;
                const habitElement = document.createElement('div');
                habitElement.className = `habit-card ${isCompleted ? 'completed' : ''}`;
                habitElement.innerHTML = `
                    <div class="habit-info">
                        <div class="habit-name">${getCategoryEmoji(habit.category)} ${habit.name}</div>
                        <div class="habit-meta">${habit.category}</div>
                    </div>
                    <div class="checkbox ${isCompleted ? 'checked' : ''}" onclick="event.stopPropagation(); toggleHabitCompletion('${habit.id}', '${today}')">
                        ${isCompleted ? '✓' : ''}
                    </div>
                `;
                todayHabitsContainer.appendChild(habitElement);
            });
        }

        function toggleHabitCompletion(habitId, date) {
            if (!tracking[date]) {
                tracking[date] = {};
            }
            
            tracking[date][habitId] = !tracking[date][habitId];
            saveUserData();
            updateDashboard();
            loadTracking(); // Refresh tracking view if active
            
            const habit = habits.find(h => h.id === habitId);
            const isCompleted = tracking[date][habitId];
            
            // Update the checkbox visually
            const checkboxes = document.querySelectorAll(`[onclick*="${habitId}"][onclick*="${date}"]`);
            checkboxes.forEach(checkbox => {
                if (isCompleted) {
                    checkbox.classList.add('checked');
                    checkbox.innerHTML = '✓';
                    checkbox.closest('.habit-card, .tracking-item').classList.add('completed');
                } else {
                    checkbox.classList.remove('checked');
                    checkbox.innerHTML = '';
                    checkbox.closest('.habit-card, .tracking-item').classList.remove('completed');
                }
            });
            
            showNotification(
                `${habit.name} marked as ${isCompleted ? 'completed' : 'incomplete'}!`,
                isCompleted ? 'success' : 'warning'
            );
        }

        // Habits management
        function showAddHabitModal() {
            document.getElementById('addHabitModal').classList.add('active');
        }

        function closeAddHabitModal() {
            document.getElementById('addHabitModal').classList.remove('active');
            
            // Reset form
            document.getElementById('habitName').value = '';
            document.getElementById('habitCategory').value = 'Learning';
            document.getElementById('habitFrequency').value = 'daily';
            document.getElementById('habitTargetTime').value = '';
            document.getElementById('habitDescription').value = '';
        }

        function addHabit() {
            const name = document.getElementById('habitName').value;
            const category = document.getElementById('habitCategory').value;
            const frequency = document.getElementById('habitFrequency').value;
            const targetTime = document.getElementById('habitTargetTime').value;
            const description = document.getElementById('habitDescription').value;

            if (!name) {
                showNotification('Please enter a habit name!', 'error');
                return;
            }

            const newHabit = {
                id: Date.now().toString(),
                name,
                category,
                frequency,
                targetTime,
                description,
                createdAt: new Date().toISOString()
            };

            habits.push(newHabit);
            saveUserData();
            closeAddHabitModal();
            loadHabits();
            updateDashboard();
            
            showNotification('Habit added successfully!', 'success');
        }

        function loadHabits() {
            const habitsList = document.getElementById('habitsList');
            habitsList.innerHTML = '';

            if (habits.length === 0) {
                habitsList.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">No habits yet. Add your first habit to get started!</p>';
                return;
            }

            habits.forEach(habit => {
                const streak = calculateHabitStreak(habit.id);
                const successRate = calculateSuccessRate(habit.id);
                
                const habitElement = document.createElement('div');
                habitElement.className = 'habit-card';
                habitElement.innerHTML = `
                    <div class="habit-info">
                        <div class="habit-name">${getCategoryEmoji(habit.category)} ${habit.name}</div>
                        <div class="habit-meta">${habit.category} • ${habit.frequency.charAt(0).toUpperCase() + habit.frequency.slice(1)}${habit.targetTime ? ` • ${habit.targetTime}` : ''}</div>
                        ${habit.description ? `<p style="margin: 8px 0 0 0; color: #888; font-size: 0.9rem; font-style: italic;">${habit.description}</p>` : ''}
                        <div class="habit-badges">
                            <span class="badge success">Streak: ${streak}</span>
                            <span class="badge ${successRate >= 80 ? 'success' : successRate >= 60 ? 'warning' : 'danger'}">Success: ${successRate}%</span>
                        </div>
                    </div>
                    <div class="habit-actions">
                        <button class="btn-icon btn-edit" onclick="editHabit('${habit.id}')" title="Edit habit">✏️</button>
                        <button class="btn-icon btn-delete" onclick="deleteHabit('${habit.id}')" title="Delete habit">🗑️</button>
                    </div>
                `;
                habitsList.appendChild(habitElement);
            });
        }

        function editHabit(habitId) {
            const habit = habits.find(h => h.id === habitId);
            if (!habit) return;

            // Populate modal with habit data
            document.getElementById('habitName').value = habit.name;
            document.getElementById('habitCategory').value = habit.category;
            document.getElementById('habitFrequency').value = habit.frequency;
            document.getElementById('habitTargetTime').value = habit.targetTime || '';
            document.getElementById('habitDescription').value = habit.description || '';

            // Change modal title and button
            document.querySelector('.modal-title').textContent = 'Edit Habit';
            document.querySelector('#addHabitModal .btn').textContent = 'Update Habit';
            document.querySelector('#addHabitModal .btn').onclick = () => updateHabit(habitId);

            showAddHabitModal();
        }

        function updateHabit(habitId) {
            const name = document.getElementById('habitName').value;
            const category = document.getElementById('habitCategory').value;
            const frequency = document.getElementById('habitFrequency').value;
            const targetTime = document.getElementById('habitTargetTime').value;
            const description = document.getElementById('habitDescription').value;

            if (!name) {
                showNotification('Please enter a habit name!', 'error');
                return;
            }

            const habitIndex = habits.findIndex(h => h.id === habitId);
            if (habitIndex !== -1) {
                habits[habitIndex] = {
                    ...habits[habitIndex],
                    name,
                    category,
                    frequency,
                    targetTime,
                    description
                };

                saveUserData();
                closeAddHabitModal();
                loadHabits();
                updateDashboard();
                
                // Reset modal
                document.querySelector('.modal-title').textContent = 'Add New Habit';
                document.querySelector('#addHabitModal .btn').textContent = 'Save Habit';
                document.querySelector('#addHabitModal .btn').onclick = addHabit;
                
                showNotification('Habit updated successfully!', 'success');
            }
        }

        function deleteHabit(habitId) {
            if (confirm('Are you sure you want to delete this habit? This will also remove all tracking data.')) {
                habits = habits.filter(h => h.id !== habitId);
                
                // Remove tracking data
                Object.keys(tracking).forEach(date => {
                    if (tracking[date][habitId]) {
                        delete tracking[date][habitId];
                    }
                });
                
                saveUserData();
                loadHabits();
                updateDashboard();
                
                showNotification('Habit deleted successfully!', 'success');
            }
        }

        // Tracking functions
        function switchTrackingView(view) {
            currentTrackingView = view;
            
            // Update view buttons
            const viewBtns = document.querySelectorAll('.view-btn');
            viewBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            loadTracking();
        }

        function loadTracking() {
            const trackingContent = document.getElementById('trackingContent');
            trackingContent.innerHTML = '';

            if (habits.length === 0) {
                trackingContent.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">No habits to track. Add some habits first!</p>';
                return;
            }

            if (currentTrackingView === 'daily') {
                loadDailyTracking();
            } else if (currentTrackingView === 'weekly') {
                loadWeeklyTracking();
            } else {
                loadMonthlyTracking();
            }
        }

        function loadDailyTracking() {
            const today = new Date().toISOString().split('T')[0];
            const dailyHabits = habits.filter(h => h.frequency === 'daily');
            const todayTracking = tracking[today] || {};

            const trackingGrid = document.createElement('div');
            trackingGrid.className = 'tracking-grid';

            const header = document.createElement('h3');
            header.textContent = `📅 ${new Date().toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            })}`;
            trackingGrid.appendChild(header);

            if (dailyHabits.length === 0) {
                trackingGrid.innerHTML += '<p style="text-align: center; color: #666; padding: 20px;">No daily habits to track!</p>';
            } else {
                dailyHabits.forEach(habit => {
                    const isCompleted = todayTracking[habit.id] || false;
                    const trackingItem = document.createElement('div');
                    trackingItem.className = `tracking-item ${isCompleted ? 'completed' : ''}`;
                    trackingItem.innerHTML = `
                        <div class="habit-info">
                            <div class="habit-name">${getCategoryEmoji(habit.category)} ${habit.name}</div>
                            <div class="habit-meta">${habit.category}</div>
                        </div>
                        <div class="checkbox ${isCompleted ? 'checked' : ''}" onclick="event.stopPropagation(); toggleHabitCompletion('${habit.id}', '${today}')">
                            ${isCompleted ? '✓' : ''}
                        </div>
                    `;
                    trackingGrid.appendChild(trackingItem);
                });
            }

            document.getElementById('trackingContent').appendChild(trackingGrid);
        }

        function loadWeeklyTracking() {
            const trackingGrid = document.createElement('div');
            trackingGrid.className = 'tracking-grid';

            const header = document.createElement('h3');
            header.textContent = '📊 Weekly View - Last 7 Days';
            trackingGrid.appendChild(header);

            // Generate last 7 days for weekly tracking
            const days = [];
            const today = new Date();
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(today.getDate() - i);
                days.push({
                    date: date.toISOString().split('T')[0],
                    label: date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })
                });
            }

            habits.forEach(habit => {
                const habitSection = document.createElement('div');
                habitSection.innerHTML = `<h4 style="margin-bottom: 16px;">${getCategoryEmoji(habit.category)} ${habit.name}</h4>`;
                
                const dayGrid = document.createElement('div');
                dayGrid.style.display = 'grid';
                dayGrid.style.gridTemplateColumns = 'repeat(7, 1fr)';
                dayGrid.style.gap = '8px';
                dayGrid.style.marginBottom = '24px';

                days.forEach(day => {
                    const dayTracking = tracking[day.date] || {};
                    const isCompleted = dayTracking[habit.id] || false;

                    const dayItem = document.createElement('div');
                    dayItem.className = `tracking-item ${isCompleted ? 'completed' : ''}`;
                    dayItem.style.padding = '12px 8px';
                    dayItem.innerHTML = `
                        <div style="text-align: center;">
                            <div style="font-size: 0.8rem; font-weight: 600; margin-bottom: 8px;">${day.label}</div>
                            <div class="checkbox ${isCompleted ? 'checked' : ''}" onclick="event.stopPropagation(); toggleHabitCompletion('${habit.id}', '${day.date}')">
                                ${isCompleted ? '✓' : ''}
                            </div>
                        </div>
                    `;
                    dayGrid.appendChild(dayItem);
                });

                habitSection.appendChild(dayGrid);
                trackingGrid.appendChild(habitSection);
            });

            document.getElementById('trackingContent').appendChild(trackingGrid);
        }

        function loadMonthlyTracking() {
            const trackingGrid = document.createElement('div');
            trackingGrid.className = 'tracking-grid';

            const header = document.createElement('h3');
            header.textContent = '📅 Monthly View - Last 30 Days';
            trackingGrid.appendChild(header);

            // Generate last 30 days for monthly tracking
            const days = [];
            const today = new Date();
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(today.getDate() - i);
                days.push({
                    date: date.toISOString().split('T')[0],
                    label: date.getDate(),
                    fullLabel: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })
                });
            }

            habits.forEach(habit => {
                const habitSection = document.createElement('div');
                habitSection.innerHTML = `<h4 style="margin-bottom: 16px;">${getCategoryEmoji(habit.category)} ${habit.name}</h4>`;
                
                const dayGrid = document.createElement('div');
                dayGrid.style.display = 'grid';
                dayGrid.style.gridTemplateColumns = 'repeat(10, 1fr)';
                dayGrid.style.gap = '6px';
                dayGrid.style.marginBottom = '24px';

                days.forEach(day => {
                    const dayTracking = tracking[day.date] || {};
                    const isCompleted = dayTracking[habit.id] || false;

                    const dayItem = document.createElement('div');
                    dayItem.className = `tracking-item ${isCompleted ? 'completed' : ''}`;
                    dayItem.style.padding = '8px 4px';
                    dayItem.style.minHeight = '60px';
                    dayItem.title = day.fullLabel;
                    dayItem.innerHTML = `
                        <div style="text-align: center;">
                            <div style="font-size: 0.7rem; font-weight: 600; margin-bottom: 6px;">${day.label}</div>
                            <div class="checkbox ${isCompleted ? 'checked' : ''}" onclick="event.stopPropagation(); toggleHabitCompletion('${habit.id}', '${day.date}')" style="width: 20px; height: 20px; font-size: 0.8rem;">
                                ${isCompleted ? '✓' : ''}
                            </div>
                        </div>
                    `;
                    dayGrid.appendChild(dayItem);
                });

                habitSection.appendChild(dayGrid);
                trackingGrid.appendChild(habitSection);
            });

            document.getElementById('trackingContent').appendChild(trackingGrid);
        }

        function saveTracking() {
            saveUserData();
            showNotification('All responses saved!', 'success');
        }

        function resetTracking() {
            if (confirm('Are you sure you want to reset tracking responses for this session?')) {
                showNotification('Responses reset for this session!', 'warning');
            }
        }

        // Progress functions
        function loadProgress() {
            generateDailyCompletionChart();
            generateStreakChart();
            generateCategoryChart();
            showNotification('Progress charts loaded!', 'success');
        }

        function generateDailyCompletionChart() {
            const chartContainer = document.querySelector('.chart-container .chart-placeholder');
            if (!chartContainer) return;

            const last30Days = [];
            const today = new Date();
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(today.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                
                const dailyHabits = habits.filter(h => h.frequency === 'daily');
                const dayTracking = tracking[dateStr] || {};
                const completed = dailyHabits.filter(h => dayTracking[h.id]).length;
                const total = dailyHabits.length;
                const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
                
                last30Days.push({
                    date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                    percentage,
                    completed,
                    total
                });
            }

            const maxPercentage = Math.max(...last30Days.map(d => d.percentage), 100);
            
            chartContainer.innerHTML = `
                <div style="display: flex; align-items: end; height: 250px; gap: 4px; padding: 20px;">
                    ${last30Days.map(day => `
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                            <div style="
                                height: ${(day.percentage / maxPercentage) * 200}px;
                                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                width: 100%;
                                border-radius: 4px 4px 0 0;
                                margin-bottom: 8px;
                                min-height: 2px;
                                position: relative;
                            " title="${day.completed}/${day.total} (${day.percentage}%)">
                                <div style="
                                    position: absolute;
                                    top: -25px;
                                    left: 50%;
                                    transform: translateX(-50%);
                                    font-size: 0.7rem;
                                    font-weight: 600;
                                    color: #333;
                                ">${day.percentage}%</div>
                            </div>
                            <div style="font-size: 0.7rem; color: #666; writing-mode: vertical-rl; text-orientation: mixed;">
                                ${day.date}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function generateStreakChart() {
            const chartContainers = document.querySelectorAll('.chart-container');
            const streakChart = chartContainers[1]?.querySelector('.chart-placeholder');
            if (!streakChart) return;

            if (habits.length === 0) {
                streakChart.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666;">Add some habits to see streak data!</div>';
                return;
            }

            const habitStreaks = habits.map(habit => ({
                name: habit.name,
                category: habit.category,
                streak: calculateHabitStreak(habit.id)
            })).sort((a, b) => b.streak - a.streak);

            const maxStreak = Math.max(...habitStreaks.map(h => h.streak), 1);

            streakChart.innerHTML = `
                <div style="padding: 20px;">
                    ${habitStreaks.map(habit => `
                        <div style="margin-bottom: 16px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span style="font-weight: 600; color: #333;">${getCategoryEmoji(habit.category)} ${habit.name}</span>
                                <span style="font-weight: 700; color: #667eea;">${habit.streak} days</span>
                            </div>
                            <div style="
                                width: 100%;
                                height: 12px;
                                background: #e2e8f0;
                                border-radius: 6px;
                                overflow: hidden;
                            ">
                                <div style="
                                    width: ${(habit.streak / maxStreak) * 100}%;
                                    height: 100%;
                                    background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
                                    border-radius: 6px;
                                    transition: width 0.3s ease;
                                "></div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function generateCategoryChart() {
            const chartContainers = document.querySelectorAll('.chart-container');
            const categoryChart = chartContainers[2]?.querySelector('.chart-placeholder');
            if (!categoryChart) return;

            if (habits.length === 0) {
                categoryChart.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666;">Add some habits to see category breakdown!</div>';
                return;
            }

            const categoryStats = {};
            habits.forEach(habit => {
                if (!categoryStats[habit.category]) {
                    categoryStats[habit.category] = {
                        count: 0,
                        totalSuccess: 0,
                        emoji: getCategoryEmoji(habit.category)
                    };
                }
                categoryStats[habit.category].count++;
                categoryStats[habit.category].totalSuccess += calculateSuccessRate(habit.id);
            });

            const categoryData = Object.entries(categoryStats).map(([category, stats]) => ({
                category,
                count: stats.count,
                avgSuccess: Math.round(stats.totalSuccess / stats.count),
                emoji: stats.emoji
            })).sort((a, b) => b.avgSuccess - a.avgSuccess);

            const colors = ['#667eea', '#764ba2', '#48bb78', '#ed8936', '#f56565', '#9f7aea', '#38b2ac', '#ecc94b'];

            categoryChart.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: center; gap: 40px; padding: 20px;">
                    <div style="flex: 1;">
                        ${categoryData.map((cat, index) => `
                            <div style="display: flex; align-items: center; margin-bottom: 16px;">
                                <div style="
                                    width: 20px;
                                    height: 20px;
                                    background: ${colors[index % colors.length]};
                                    border-radius: 4px;
                                    margin-right: 12px;
                                "></div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; color: #333;">${cat.emoji} ${cat.category}</div>
                                    <div style="font-size: 0.9rem; color: #666;">${cat.count} habits • ${cat.avgSuccess}% success</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="position: relative; width: 200px; height: 200px;">
                        <svg width="200" height="200" style="transform: rotate(-90deg);">
                            ${categoryData.map((cat, index) => {
                                const total = categoryData.reduce((sum, c) => sum + c.count, 0);
                                const percentage = (cat.count / total) * 100;
                                const circumference = 2 * Math.PI * 80;
                                const strokeDasharray = (percentage / 100) * circumference;
                                const strokeDashoffset = index === 0 ? 0 : 
                                    categoryData.slice(0, index).reduce((sum, c) => sum + ((c.count / total) * circumference), 0);
                                
                                return `
                                    <circle
                                        cx="100"
                                        cy="100"
                                        r="80"
                                        fill="none"
                                        stroke="${colors[index % colors.length]}"
                                        stroke-width="20"
                                        stroke-dasharray="${strokeDasharray} ${circumference}"
                                        stroke-dashoffset="-${strokeDashoffset}"
                                    />
                                `;
                            }).join('')}
                        </svg>
                        <div style="
                            position: absolute;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            text-align: center;
                            color: #333;
                        ">
                            <div style="font-size: 1.5rem; font-weight: 700;">${habits.length}</div>
                            <div style="font-size: 0.9rem;">Total Habits</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function exportCSV() {
            const csvData = generateCSVData();
            const blob = new Blob([csvData], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `habitara_export_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('Data exported successfully!', 'success');
        }

        function generateCSVData() {
            let csv = 'Habit,Category,Frequency,Date,Completed,Notes\n';
            
            habits.forEach(habit => {
                Object.keys(tracking).forEach(date => {
                    if (tracking[date][habit.id] !== undefined) {
                        const completed = tracking[date][habit.id] ? 'Yes' : 'No';
                        csv += `"${habit.name}","${habit.category}","${habit.frequency}","${date}","${completed}",""\n`;
                    }
                });
            });
            
            return csv;
        }

        // AI Insights functions
        function loadAIInsights() {
            analyzeHabitRisks();
            generateAISuggestions();
            loadBadges();
        }

        function analyzeHabitRisks() {
            const highRisk = [];
            const mediumRisk = [];
            const lowRisk = [];

            habits.forEach(habit => {
                const successRate = calculateSuccessRate(habit.id);
                const streak = calculateHabitStreak(habit.id);

                if (successRate < 30 || streak === 0) {
                    highRisk.push(habit);
                } else if (successRate < 70 || streak < 3) {
                    mediumRisk.push(habit);
                } else {
                    lowRisk.push(habit);
                }
            });

            // Update risk displays
            updateRiskDisplay('highRiskHabits', highRisk, 'No high-risk habits! 🎉');
            updateRiskDisplay('mediumRiskHabits', mediumRisk, 'No medium-risk habits!');
            updateRiskDisplay('lowRiskHabits', lowRisk, 'Keep building habits!');
        }

        function updateRiskDisplay(containerId, habits, emptyMessage) {
            const container = document.getElementById(containerId);
            
            if (habits.length === 0) {
                container.innerHTML = `<p>${emptyMessage}</p>`;
            } else {
                container.innerHTML = habits.slice(0, 3).map(habit => 
                    `<p>• ${habit.name} (${calculateSuccessRate(habit.id)}%)</p>`
                ).join('');
            }
        }

        function generateAISuggestions() {
            const suggestions = [];
            
            if (habits.length === 0) {
                suggestions.push('Start by adding your first habit! Focus on something small and achievable.');
            } else {
                const avgSuccessRate = habits.reduce((sum, habit) => sum + calculateSuccessRate(habit.id), 0) / habits.length;
                const maxStreak = Math.max(...habits.map(habit => calculateHabitStreak(habit.id)));
                
                if (avgSuccessRate > 80) {
                    suggestions.push('Amazing consistency! You might be ready to increase the difficulty or frequency of some habits.');
                } else if (avgSuccessRate < 50) {
                    suggestions.push('Focus on fewer habits initially. It\'s better to master 2-3 habits than to struggle with many.');
                }
                
                if (maxStreak >= 30) {
                    suggestions.push('Congratulations on your impressive streaks! Consider sharing your success strategies with others.');
                } else if (maxStreak < 7) {
                    suggestions.push('Focus on building small streaks first. Even 3-day streaks can build momentum for longer success.');
                }
                
                const categories = new Set(habits.map(h => h.category));
                if (categories.size < 3) {
                    suggestions.push('Consider diversifying your habits across different categories (Health, Learning, Productivity) for balanced personal growth.');
                }
            }

            const suggestionsList = document.getElementById('aiSuggestions');
            suggestionsList.innerHTML = suggestions.map(suggestion => 
                `<li class="suggestion-item">${suggestion}</li>`
            ).join('');
        }

        function loadBadges() {
            const badges = calculateBadges();
            const badgesContainer = document.getElementById('badgesContainer');
            
            if (badges.length === 0) {
                badgesContainer.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;"><p>Keep building habits to earn your first badge!</p></div>';
            } else {
                badgesContainer.innerHTML = badges.map(badge => `
                    <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); border-radius: 16px;">
                        <div style="font-size: 3rem; margin-bottom: 12px;">${badge.icon}</div>
                        <h4 style="margin: 0; color: #b45309;">${badge.name}</h4>
                        <p style="margin: 0; color: #92400e; font-size: 0.9rem;">${badge.description}</p>
                    </div>
                `).join('');
            }
        }

        function calculateBadges() {
            const badges = [];
            
            if (habits.length === 0) return badges;
            
            const maxStreak = Math.max(...habits.map(habit => calculateHabitStreak(habit.id)));
            
            if (maxStreak >= 100) {
                badges.push({ name: 'Centurion', icon: '👑', description: '100+ day streak' });
            } else if (maxStreak >= 50) {
                badges.push({ name: 'Streak Legend', icon: '🏆', description: '50+ day streak' });
            } else if (maxStreak >= 30) {
                badges.push({ name: 'Streak Master', icon: '🥇', description: '30+ day streak' });
            } else if (maxStreak >= 14) {
                badges.push({ name: 'Two Week Warrior', icon: '🔥', description: '14+ day streak' });
            } else if (maxStreak >= 7) {
                badges.push({ name: 'Week Warrior', icon: '⭐', description: '7+ day streak' });
            } else if (maxStreak >= 3) {
                badges.push({ name: 'Getting Started', icon: '🌱', description: '3+ day streak' });
            }
            
            if (habits.length >= 20) {
                badges.push({ name: 'Habit Master', icon: '🎯', description: '20+ habits created' });
            } else if (habits.length >= 10) {
                badges.push({ name: 'Habit Collector', icon: '📚', description: '10+ habits created' });
            } else if (habits.length >= 5) {
                badges.push({ name: 'Habit Builder', icon: '🏗️', description: '5+ habits created' });
            }
            
            const avgSuccessRate = habits.reduce((sum, habit) => sum + calculateSuccessRate(habit.id), 0) / habits.length;
            if (avgSuccessRate >= 90) {
                badges.push({ name: 'Perfectionist', icon: '💎', description: '90%+ success rate' });
            } else if (avgSuccessRate >= 75) {
                badges.push({ name: 'Consistent Performer', icon: '🎖️', description: '75%+ success rate' });
            }
            
            return badges;
        }

        // Settings functions
        function loadSettings() {
            const users = JSON.parse(localStorage.getItem('habitara_users') || '{}');
            const userData = users[currentUser] || {};
            
            document.getElementById('profileFullName').value = userData.fullName || '';
            document.getElementById('profileEmail').value = userData.email || '';
            document.getElementById('profileUsername').value = currentUser || '';
            
            // Load theme toggle
            const themeToggle = document.getElementById('themeToggle');
            if (currentTheme === 'dark') {
                themeToggle.classList.add('active');
            }
            
            // Load language buttons
            const languageBtns = document.querySelectorAll('.language-btn');
            languageBtns.forEach(btn => {
                btn.classList.remove('active');
                if (btn.onclick.toString().includes(currentLanguage)) {
                    btn.classList.add('active');
                }
            });
        }

        function updateProfile() {
            const fullName = document.getElementById('profileFullName').value;
            const email = document.getElementById('profileEmail').value;
            const username = document.getElementById('profileUsername').value;
            
            if (!fullName || !email || !username) {
                showNotification('Please fill in all fields!', 'error');
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('habitara_users') || '{}');
            
            // Check if username is available (if changed)
            if (username !== currentUser && users[username]) {
                showNotification('Username already exists!', 'error');
                return;
            }
            
            // Update user data
            if (username !== currentUser) {
                // Username changed - need to migrate data
                users[username] = { ...users[currentUser], fullName, email };
                delete users[currentUser];
                
                // Migrate habits and tracking data
                const oldHabitsKey = `habitara_habits_${currentUser}`;
                const oldTrackingKey = `habitara_tracking_${currentUser}`;
                const newHabitsKey = `habitara_habits_${username}`;
                const newTrackingKey = `habitara_tracking_${username}`;
                
                localStorage.setItem(newHabitsKey, localStorage.getItem(oldHabitsKey) || '[]');
                localStorage.setItem(newTrackingKey, localStorage.getItem(oldTrackingKey) || '{}');
                localStorage.removeItem(oldHabitsKey);
                localStorage.removeItem(oldTrackingKey);
                
                currentUser = username;
                localStorage.setItem('habitara_current_user', username);
                document.getElementById('currentUser').textContent = username;
            } else {
                users[currentUser] = { ...users[currentUser], fullName, email };
            }
            
            localStorage.setItem('habitara_users', JSON.stringify(users));
            showNotification('Profile updated successfully!', 'success');
        }

        function uploadProfilePicture() {
            const file = document.getElementById('profilePictureInput').files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = document.createElement('img');
                img.src = e.target.result;
                img.className = 'profile-picture';
                
                const container = document.getElementById('profilePicture');
                container.innerHTML = '';
                container.appendChild(img);
                
                // Save to localStorage (in a real app, you'd upload to a server)
                const users = JSON.parse(localStorage.getItem('habitara_users') || '{}');
                users[currentUser] = { ...users[currentUser], profilePicture: e.target.result };
                localStorage.setItem('habitara_users', JSON.stringify(users));
                
                showNotification('Profile picture updated!', 'success');
            };
            reader.readAsDataURL(file);
        }

        function resetProfilePicture() {
            document.getElementById('profilePicture').innerHTML = '<div class="profile-placeholder">👤</div>';
            
            const users = JSON.parse(localStorage.getItem('habitara_users') || '{}');
            if (users[currentUser]) {
                delete users[currentUser].profilePicture;
                localStorage.setItem('habitara_users', JSON.stringify(users));
            }
            
            showNotification('Profile picture reset!', 'success');
        }

        function toggleTheme() {
            const themeToggle = document.getElementById('themeToggle');
            themeToggle.classList.toggle('active');
            
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            applyTheme();
            
            // Save theme preference
            const users = JSON.parse(localStorage.getItem('habitara_users') || '{}');
            users[currentUser] = { ...users[currentUser], theme: currentTheme };
            localStorage.setItem('habitara_users', JSON.stringify(users));
            
            showNotification(`Switched to ${currentTheme} theme!`, 'success');
        }

        function applyTheme() {
            if (currentTheme === 'dark') {
                document.body.classList.add('dark-theme');
            } else {
                document.body.classList.remove('dark-theme');
            }
        }

        function setLanguage(lang) {
            currentLanguage = lang;
            
            // Update language buttons
            const languageBtns = document.querySelectorAll('.language-btn');
            languageBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            applyLanguage();
            
            // Save language preference
            const users = JSON.parse(localStorage.getItem('habitara_users') || '{}');
            users[currentUser] = { ...users[currentUser], language: currentLanguage };
            localStorage.setItem('habitara_users', JSON.stringify(users));
            
            showNotification('Language updated!', 'success');
        }

        function applyLanguage() {
            const t = translations[currentLanguage] || translations.en;
            
            // Update text content
            document.getElementById('welcomeTitle').textContent = t.welcome;
            document.getElementById('welcomeSubtitle').textContent = t.subtitle;
            document.getElementById('sidebarSubtitle').textContent = t.subtitle;
            document.getElementById('navDashboard').textContent = t.dashboard;
            document.getElementById('navHabits').textContent = t.habits;
            document.getElementById('navTracking').textContent = t.tracking;
            document.getElementById('navProgress').textContent = t.progress;
            document.getElementById('navAI').textContent = t.aiInsights;
            document.getElementById('navSettings').textContent = t.settings;
            document.getElementById('navLogout').textContent = t.logout;
            document.getElementById('dashboardTitle').textContent = t.dashboard;
            document.getElementById('habitsTitle').textContent = t.habits;
            document.getElementById('trackingTitle').textContent = t.tracking;
            document.getElementById('progressTitle').textContent = t.progress;
            document.getElementById('aiInsightsTitle').textContent = t.aiInsights;
            document.getElementById('settingsTitle').textContent = t.settings;
            document.getElementById('totalHabitsLabel').textContent = t.totalHabits;
            document.getElementById('todayProgressLabel').textContent = t.todayProgress;
            document.getElementById('longestStreakLabel').textContent = t.longestStreak;
            document.getElementById('completedTodayLabel').textContent = t.completedToday;
        }

        function savePrivacySettings() {
            const notifications = document.getElementById('enableNotifications').checked;
            const shareProgress = document.getElementById('shareProgress').checked;
            const reminderTime = document.getElementById('reminderTime').value;
            
            // Save settings (in a real app, this would be saved to a database)
            const settings = {
                notifications,
                shareProgress,
                reminderTime
            };
            
            localStorage.setItem(`habitara_settings_${currentUser}`, JSON.stringify(settings));
            showNotification('Privacy settings saved!', 'success');
        }

        function resetAllSettings() {
            if (confirm('Are you sure you want to reset all settings to default values?')) {
                // Reset theme and language
                currentTheme = 'light';
                currentLanguage = 'en';
                
                // Update UI
                document.getElementById('themeToggle').classList.remove('active');
                applyTheme();
                applyLanguage();
                
                // Reset form values
                document.getElementById('enableNotifications').checked = true;
                document.getElementById('shareProgress').checked = false;
                document.getElementById('reminderTime').value = '09:00';
                
                // Reset profile picture
                resetProfilePicture();
                
                // Save to localStorage
                const users = JSON.parse(localStorage.getItem('habitara_users') || '{}');
                users[currentUser] = { 
                    ...users[currentUser], 
                    theme: 'light', 
                    language: 'en' 
                };
                localStorage.setItem('habitara_users', JSON.stringify(users));
                localStorage.removeItem(`habitara_settings_${currentUser}`);
                
                showNotification('All settings reset to default!', 'success');
            }
        }

        // Utility functions
        function getCategoryEmoji(category) {
            const emojis = {
                'Learning': '📚',
                'Saving': '💰',
                'Health': '🏥',
                'Fitness': '💪',
                'Productivity': '⚡',
                'Mindfulness': '🧘',
                'Reading': '📖',
                'Social': '👥',
                'Custom': '🎯'
            };
            return emojis[category] || '🎯';
        }

        function calculateHabitStreak(habitId) {
            const today = new Date();
            let streak = 0;
            let currentDate = new Date(today);
            
            while (true) {
                const dateStr = currentDate.toISOString().split('T')[0];
                const dayTracking = tracking[dateStr];
                
                if (dayTracking && dayTracking[habitId]) {
                    streak++;
                    currentDate.setDate(currentDate.getDate() - 1);
                } else if (dateStr === today.toISOString().split('T')[0]) {
                    // Today not completed yet, check yesterday
                    currentDate.setDate(currentDate.getDate() - 1);
                } else {
                    break;
                }
            }
            
            return streak;
        }

        function calculateLongestStreak() {
            if (habits.length === 0) return 0;
            
            return Math.max(...habits.map(habit => calculateHabitStreak(habit.id)));
        }

        function calculateSuccessRate(habitId, days = 30) {
            const endDate = new Date();
            const startDate = new Date();
            startDate.setDate(endDate.getDate() - days + 1);
            
            let totalDays = 0;
            let completedDays = 0;
            
            const currentDate = new Date(startDate);
            while (currentDate <= endDate) {
                const dateStr = currentDate.toISOString().split('T')[0];
                const dayTracking = tracking[dateStr];
                
                if (dayTracking && dayTracking.hasOwnProperty(habitId)) {
                    totalDays++;
                    if (dayTracking[habitId]) {
                        completedDays++;
                    }
                }
                
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            return totalDays > 0 ? Math.round((completedDays / totalDays) * 100) : 0;
        }

        function getCompletedDaysInRange(habitId, startDate, endDate) {
            let completed = 0;
            let total = 0;
            
            const currentDate = new Date(startDate);
            const end = new Date(endDate);
            
            while (currentDate <= end) {
                const dateStr = currentDate.toISOString().split('T')[0];
                const dayTracking = tracking[dateStr];
                
                if (dayTracking && dayTracking.hasOwnProperty(habitId)) {
                    total++;
                    if (dayTracking[habitId]) {
                        completed++;
                    }
                }
                
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            return { completed, total };
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function checkNotifications() {
            if (!currentUser) return;
            
            const today = new Date().toISOString().split('T')[0];
            const dailyHabits = habits.filter(h => h.frequency === 'daily');
            const todayTracking = tracking[today] || {};
            
            const incompleteHabits = dailyHabits.filter(habit => !todayTracking[habit.id]);
            
            if (incompleteHabits.length > 0) {
                setTimeout(() => {
                    showNotification(
                        `You have ${incompleteHabits.length} incomplete habits today!`,
                        'warning'
                    );
                }, 2000);
            }
        }

        // Auto-save functionality
        setInterval(() => {
            if (currentUser) {
                saveUserData();
            }
        }, 30000); // Auto-save every 30 seconds
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97724f70462a54e6',t:'MTc1NjUzNjE2OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
